const CACHE_NAME = `version-1`;
const urlsToCache = ["index.html", "offline.html"];

const self = this;

// Install SW
self.addEventListener("install", (event) => {
  event.waitUntil(
    caches.open(CACHE_NAME).then((cache) => {
      console.log("Opened cache");

      return cache.addAll(urlsToCache);
    })
  );
});

// Listen for request
self.addEventListener("fetch", (event) => {
  event.respondWith(
    caches.match(event.request).then(() => {
      return fetch(event.request).catch(() => caches.match("offline.html"));
    })
  );
});

// Activate the SW
self.addEventListener("activate", (event) => {
  const cacheWhiteList = [];
  cacheWhiteList.push(CACHE_NAME);

  event.waitUntil(
    caches.keys().then((cachesNames) =>
      Promise.all(
        cachesNames.map((cacheName) => {
          if (!cacheWhiteList.includes(cacheName)) {
            return caches.delete(cacheName);
          }
        })
      )
    )
  );
});

self.addEventListener("push", (e) => {
  const data = e.data.json();
  const { mensaje, title, image } = data;
  console.log("Push Recieved...");
  self.registration.showNotification(title, {
    body: mensaje,
    image: image,
    icon:
      "data:image/png;base64,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",
    badge:
      "data:image/png;base64,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",
  });
});
